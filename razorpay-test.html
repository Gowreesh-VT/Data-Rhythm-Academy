<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Razorpay Integration Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #3B82F6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        .test-button:hover {
            background: #2563EB;
        }
        .success {
            background: #10B981;
        }
        .error {
            background: #EF4444;
        }
        .info {
            background: #3B82F6;
            color: white;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .warning {
            background: #F59E0B;
            color: white;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
            display: none;
        }
    </style>
</head>
<body>
    <h1>üöÄ Razorpay Integration Test</h1>
    
    <div class="info">
        <strong>Note:</strong> This is a test page to verify Razorpay integration. Use test payment methods only.
    </div>

    <div class="test-card">
        <h2>üí≥ Test Payment - ‚Çπ2999 Course</h2>
        <p><strong>Course:</strong> React + TypeScript Masterclass</p>
        <p><strong>Price:</strong> ‚Çπ2999 + ‚Çπ540 GST = ‚Çπ3539</p>
        <button class="test-button" onclick="testPayment(2999, 'React + TypeScript Masterclass')">
            Pay with Razorpay
        </button>
        <div id="result1" class="result"></div>
    </div>

    <div class="test-card">
        <h2>üí∞ Test Payment - ‚Çπ4999 Course</h2>
        <p><strong>Course:</strong> Full Stack Development Bootcamp</p>
        <p><strong>Price:</strong> ‚Çπ4999 + ‚Çπ900 GST = ‚Çπ5899</p>
        <button class="test-button" onclick="testPayment(4999, 'Full Stack Development Bootcamp')">
            Pay with Razorpay
        </button>
        <div id="result2" class="result"></div>
    </div>

    <div class="test-card">
        <h2>üéØ Test Payment - ‚Çπ1999 Course</h2>
        <p><strong>Course:</strong> Python for Data Science</p>
        <p><strong>Price:</strong> ‚Çπ1999 + ‚Çπ360 GST = ‚Çπ2359</p>
        <button class="test-button" onclick="testPayment(1999, 'Python for Data Science')">
            Pay with Razorpay
        </button>
        <div id="result3" class="result"></div>
    </div>

    <div class="warning">
        <h3>üß™ Test Payment Details</h3>
        <p><strong>Test Card Number:</strong> 4111 1111 1111 1111</p>
        <p><strong>Expiry:</strong> Any future date</p>
        <p><strong>CVV:</strong> Any 3 digits</p>
        <p><strong>UPI ID:</strong> success@razorpay (for success) or failure@razorpay (for failure)</p>
    </div>

    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script>
        // Test configuration
        const RAZORPAY_KEY = 'rzp_test_11111111111111'; // Replace with your test key
        
        function formatAmount(amount) {
            return new Intl.NumberFormat('en-IN', {
                style: 'currency',
                currency: 'INR',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function calculateTotal(baseAmount) {
            const gst = Math.round(baseAmount * 0.18);
            const total = baseAmount + gst;
            return { baseAmount, gst, total };
        }

        function showResult(resultId, success, message, details = '') {
            const resultDiv = document.getElementById(resultId);
            resultDiv.style.display = 'block';
            resultDiv.className = `result ${success ? 'success' : 'error'}`;
            resultDiv.innerHTML = `
                <strong>${success ? '‚úÖ Success!' : '‚ùå Failed!'}</strong><br>
                ${message}<br>
                ${details ? `<small>${details}</small>` : ''}
            `;
        }

        function testPayment(amount, courseTitle) {
            const resultId = `result${amount === 2999 ? '1' : amount === 4999 ? '2' : '3'}`;
            
            // Calculate pricing
            const { baseAmount, gst, total } = calculateTotal(amount);
            
            console.log('üéØ Initiating test payment:', {
                courseTitle,
                baseAmount,
                gst,
                total
            });

            // Check if Razorpay is loaded
            if (typeof Razorpay === 'undefined') {
                showResult(resultId, false, 'Razorpay script not loaded', 'Please check your internet connection');
                return;
            }

            // Create Razorpay order (mock)
            const orderId = `order_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
            
            const options = {
                key: RAZORPAY_KEY,
                amount: total * 100, // Amount in paise
                currency: 'INR',
                name: 'Data Rhythm Academy',
                description: `Payment for ${courseTitle}`,
                order_id: orderId,
                prefill: {
                    name: 'Test Student',
                    email: 'test@datarhythmacademy.in',
                    contact: '9999999999'
                },
                theme: {
                    color: '#3B82F6'
                },
                handler: function(response) {
                    console.log('‚úÖ Payment successful:', response);
                    showResult(
                        resultId, 
                        true, 
                        `Payment completed successfully!`,
                        `Payment ID: ${response.razorpay_payment_id}<br>
                         Order ID: ${response.razorpay_order_id}<br>
                         Amount: ${formatAmount(total)}`
                    );
                },
                modal: {
                    ondismiss: function() {
                        console.log('‚ö†Ô∏è Payment cancelled by user');
                        showResult(resultId, false, 'Payment cancelled', 'You cancelled the payment process');
                    }
                }
            };

            try {
                const rzp = new Razorpay(options);
                rzp.open();
            } catch (error) {
                console.error('‚ùå Error opening Razorpay:', error);
                showResult(resultId, false, 'Failed to open payment', error.message);
            }
        }

        // Log environment info
        console.log('üîß Razorpay Test Environment');
        console.log('Razorpay Key:', RAZORPAY_KEY);
        console.log('Test Mode: Enabled');
        console.log('Available Payment Methods: Cards, UPI, Net Banking, Wallets');
    </script>
</body>
</html>